(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{8511:(e,s,t)=>{Promise.resolve().then(t.bind(t,5871))},6855:(e,s,t)=>{"use strict";t.d(s,{N:()=>r});let r=(0,t(5974).UU)("https://bqexmwjcmtyypzucndrb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxZXhtd2pjbXR5eXB6dWNuZHJiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA2MjA5NjQsImV4cCI6MjA1NjE5Njk2NH0.LgmwOIcW4UsTqwigP7BgXBrQmtSah362_dsWqjecTQQ")},2558:(e,s,t)=>{"use strict";t.d(s,{C:()=>i});var r=t(1455),a=t.n(r);t(1550);var l=t(4084),n=t.n(l);a().extend(n());let c=e=>e.replace("Sunday","日曜日").replace("Monday","月曜日").replace("Tuesday","火曜日").replace("Wednesday","水曜日").replace("Thursday","木曜日").replace("Friday","金曜日").replace("Saturday","土曜日").replace("曜日",""),i=e=>{var s,t,r,l;let n=a()().locale("ja"),i=n;6>n.hour()&&(i=n.subtract(1,"day"));let d=c(i.format("dddd")),o=c(i.add(1,"day").format("dddd")),m=n.format("HH:mm");console.log("\uD83D\uDCC6 現在の曜日: '".concat(d,"', 時刻: ").concat(m)),console.log("\uD83D\uDD0D Supabase から取得した営業時間のデータ:",e);let h={};e.split("\n").forEach(e=>{let s=e.match(/^(.+?曜)\s*(.+)$/);if(s&&s[1]&&s[2]){let e=s[1].trim(),t=s[2].trim();if("休み"===t)h[e]=[];else{let s=t.split(", ");h[e]=s.map(e=>{let[s,t]=e.split("〜").map(e=>e.trim());return{open:s,close:t}})}}}),console.log("\uD83D\uDDFA 営業時間マップのキー:",Object.keys(h)),console.log("\uD83D\uDD0D 検索対象:",d);let p=Object.keys(h).find(e=>e.startsWith(d));if(!p||!h.hasOwnProperty(p)||!Array.isArray(h[p])||(null===(s=h[p])||void 0===s?void 0:s.length)===0){console.warn("⚠️ '".concat(d,"' は休業日"));let e=Object.keys(h).find(e=>e.startsWith(o));return e&&h.hasOwnProperty(e)&&Array.isArray(h[e])?{isOpen:!1,nextOpening:"次の営業: ".concat(e," ").concat(null===(t=h[e][0])||void 0===t?void 0:t.open," から")}:{isOpen:!1,nextOpening:"営業情報なし"}}let x=h[p]||[];if(console.log("\uD83D\uDCC6 今日(".concat(d,") の営業時間:"),x),!x.length)return{isOpen:!1,nextOpening:"情報なし"};let u="",b=!1;for(let e of x){let s=parseInt(e.open.split(":")[0],10),t=parseInt(e.open.split(":")[1],10),r=parseInt(e.close.split(":")[0],10),a=parseInt(e.close.split(":")[1],10),l=i.set("hour",s).set("minute",t),c=i.set("hour",r).set("minute",a);if(r>=24&&(r-=24,c=i.add(1,"day").set("hour",r).set("minute",a)),console.log("\uD83D\uDD52 営業時間: ".concat(l.format("YYYY-MM-DD HH:mm")," 〜 ").concat(c.format("YYYY-MM-DD HH:mm"))),n.isBetween(l,c,null,"[)")){b=!0,u="本日 ".concat(c.format("HH:mm")," まで営業");break}}if(!b){if(6>n.hour())return{isOpen:!1,nextOpening:""};let e=x.filter(e=>a()("".concat(i.format("YYYY-MM-DD")," ").concat(e.open)).isAfter(i));if(e.length>0)u="次の営業: ".concat(d," ").concat(null===(r=e[0])||void 0===r?void 0:r.open," から");else{let e=Object.keys(h).find(e=>e.startsWith(o));e&&h[e].length>0&&(u="次の営業: ".concat(e," ").concat(null===(l=h[e][0])||void 0===l?void 0:l.open," から"))}}return{isOpen:b,nextOpening:u}}},5871:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var r=t(5155),a=t(6046),l=t(2115),n=t(6855),c=t(5565),i=t(2558);function d(){let e=(0,a.useRouter)(),s=(0,a.useSearchParams)(),{id:t}=(0,a.useParams)(),[d,o]=(0,l.useState)(null),[m,h]=(0,l.useState)(!0),[p,x]=(0,l.useState)(null),u=s.get("prev")||"",b=s.toString();if((0,l.useEffect)(()=>{(async()=>{let{data:e,error:s}=await n.N.from("stores").select("*").eq("id",t).single();s?(console.error("\uD83D\uDD25 Supabase Error:",s.message),o(null)):o(e),h(!1)})();let e=sessionStorage.getItem("mapCenter");if(e){let s=JSON.parse(e);x(s),sessionStorage.setItem("mapCenter",JSON.stringify(s))}},[t]),m)return(0,r.jsx)("p",{className:"text-center text-gray-600",children:"ロード中..."});if(!d)return(0,r.jsx)("p",{className:"text-center text-red-500",children:"店舗が見つかりませんでした。"});let{isOpen:j,nextOpening:g}=(0,i.C)(d.opening_hours);return(0,r.jsx)("div",{className:"min-h-screen bg-[#FDFBF7] text-gray-800 ",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto bg-[#FDFBF7] shadow-md rounded-lg overflow-hidden",children:[d.image_url&&(0,r.jsx)(c.default,{src:d.image_url,alt:d.name,width:800,height:400,className:"w-full h-[120px] object-cover"}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-1",children:d.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:d.description}),(0,r.jsxs)("div",{className:"mb-6 text-sm space-y-2",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"ジャンル:"})," ",d.genre]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"入場料:"})," ",d.entry_fee]}),(0,r.jsx)("p",{className:j?"text-green-600 font-semibold":"text-red-500 font-semibold",children:j?"営業中":"営業時間外"}),(0,r.jsx)("p",{className:"text-sm text-gray-700",children:j?"終了時間：".concat(g):"次の営業：".concat(g,"から")})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("p",{className:"font-semibold mb-2",children:"■ 支払い方法"}),(0,r.jsxs)("table",{className:"w-full border border-gray-300 text-sm text-center",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border px-4 py-2 bg-[#FDFBF7]",children:"現金"}),(0,r.jsx)("th",{className:"border px-4 py-2 bg-[#FDFBF7]",children:"クレジットカード"}),(0,r.jsx)("th",{className:"border px-4 py-2 bg-[#FDFBF7]",children:"電子マネー"})]})}),(0,r.jsx)("tbody",{children:(0,r.jsx)("tr",{children:["現金","クレジットカード","電子マネー"].map(e=>(0,r.jsx)("td",{className:"border px-4 py-2",children:d.payment_methods.includes(e)?"◯":""},e))})})]})]}),(0,r.jsx)("div",{className:"my-10",children:(0,r.jsxs)("div",{className:"mb-10",children:[(0,r.jsx)("p",{className:"font-semibold my-4",children:"■ 店舗情報"}),(0,r.jsx)("table",{className:"w-full border border-gray-300 text-sm",children:(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border px-4 py-4 bg-[#FDFBF7] text-left w-32",children:"店舗名"}),(0,r.jsx)("td",{className:"border px-4 py-4",children:d.name})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border px-4 py-4 bg-[#FDFBF7] text-left",children:"所在地"}),(0,r.jsx)("td",{className:"border px-4 py-4",children:d.address})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border px-4 py-4 bg-[#FDFBF7] text-left",children:"アクセス"}),(0,r.jsx)("td",{className:"border px-4 py-4",children:d.access})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border px-4 py-4 bg-[#FDFBF7] text-left",children:"営業時間"}),(0,r.jsx)("td",{className:"border px-4 py-4 whitespace-pre-wrap",children:d.opening_hours})]})]})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"※日により変更する可能性があります。"})]})}),d.map_embed&&(0,r.jsx)("div",{className:"my-6",children:(0,r.jsx)("iframe",{src:d.map_embed,width:"100%",height:"300",loading:"lazy",allowFullScreen:!0,referrerPolicy:"no-referrer-when-downgrade",className:"border-0 w-full h-64 rounded"})}),d.website&&(0,r.jsx)("a",{href:d.website,target:"_blank",rel:"noopener noreferrer",className:"block w-full text-center bg-black text-white py-2 rounded hover:bg-gray-800",children:"公式サイト →"}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)("button",{onClick:()=>{"/map"===u?(p&&sessionStorage.setItem("mapCenter",JSON.stringify(p)),e.push("/map?".concat(b))):e.back()},className:"text-base text-blue-600 underline hover:text-blue-800 font-medium",children:"← 戻る"})}),(0,r.jsx)("div",{className:"mt-4 text-sm text-gray-800",children:(0,r.jsxs)("nav",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"hover:underline",children:"トップに戻る"}),(0,r.jsx)("span",{children:"/"}),(0,r.jsx)("button",{onClick:()=>e.push("/search"),className:"hover:underline",children:"条件検索"}),(0,r.jsx)("span",{children:"/"}),(0,r.jsx)("button",{onClick:()=>e.push("/map"),className:"hover:underline",children:"地図から探す"})]})})]})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[145,565,441,517,358],()=>s(8511)),_N_E=e.O()}]);