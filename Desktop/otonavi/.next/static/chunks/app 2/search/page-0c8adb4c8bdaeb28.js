(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[959],{3689:(e,t,s)=>{Promise.resolve().then(s.bind(s,4653))},4653:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var n=s(5155),l=s(2115),r=s(6046),a=s(3258),c=s(6855),i=s(2558),d=s(8173),u=s.n(d);function o(e){let{selectedGenres:t,selectedAreas:s,selectedPayments:a,showOnlyOpen:d,isSearchTriggered:o}=e,x=(0,r.useRouter)(),h=(0,r.useSearchParams)().toString(),[p,m]=(0,l.useState)([]),[f,g]=(0,l.useState)(!1),[j,v]=(0,l.useState)(null);(0,l.useEffect)(()=>{o&&y()},[o]);let y=async()=>{g(!0),v(null);let e=c.N.from("stores").select("*");t.length>0&&(e=e.in("genre",t)),s.length>0&&(e=e.in("area",s)),a.length>0&&(e=e.overlaps("payment_methods",a));let{data:n,error:l}=await e;l?(v(l.message),m([])):m(d?n.filter(e=>(0,i.C)(e.opening_hours).isOpen):n||[]),g(!1)};return(0,n.jsx)("div",{className:"w-full mt-6 bg-[#FEFCF6]",children:o?f?(0,n.jsx)("p",{className:"mt-6",children:"ロード中..."}):j?(0,n.jsxs)("p",{className:"mt-6 text-red-500",children:["⚠️ エラーが発生しました: ",j]}):0===p.length?(0,n.jsx)("p",{className:"text-gray-400 mt-6",children:"該当する店舗がありません。"}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-lg font-semibold mb-6 text-center py-[20px] text-gray-700",children:["検索結果 ",(0,n.jsx)("span",{className:"text-[#4B5C9E]",children:p.length})," 件"]}),(0,n.jsx)("div",{children:p.map((e,t)=>{var s,l;let{isOpen:r,nextOpening:a}=(0,i.C)(e.opening_hours);return(0,n.jsxs)("div",{className:"bg-[#FEFCF6] rounded-xl",children:[(0,n.jsx)(u(),{href:"/stores/".concat(e.id,"?prev=/search&").concat(h),passHref:!0,children:(0,n.jsxs)("div",{className:"cursor-pointer space-y-3 pt-4",children:[(0,n.jsx)("h3",{className:"text-[16px] font-bold text-[#1F1F21] leading-snug",children:e.name}),(0,n.jsx)("p",{className:"text-[12px] text-[#000000] leading-relaxed text-left",children:null!==(s=e.description)&&void 0!==s?s:"渋谷で40年の歴史を持つ老舗クラブ。最高音質の音響システムを導入している。"}),(0,n.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,n.jsx)("div",{className:"w-[160px] h-[90px] border-2 border-black rounded-[8px] overflow-hidden",children:(0,n.jsx)("img",{src:null!==(l=e.image_url)&&void 0!==l?l:"/default-image.jpg",alt:e.name,className:"w-full h-full object-cover"})}),(0,n.jsxs)("div",{className:"text-left space-y-1 text-[14px] text-[#1F1F21]",children:[(0,n.jsxs)("p",{children:[e.area," / ",e.genre]}),(0,n.jsx)("p",{className:"font-semibold ".concat(r?"text-green-600":"text-red-500"),children:r?"営業中":"営業時間外"}),(0,n.jsx)("p",{className:"text-xs text-[#1F1F21]",children:a})]})]})]})}),t!==p.length-1&&(0,n.jsx)("hr",{className:"mt-6 border-t border-gray-300 w-screen -mx-4"})]},e.id)})}),(0,n.jsx)("div",{className:"bg-[#FEFCF6] text-sm text-gray-800 mt-8",children:(0,n.jsxs)("nav",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"hover:underline",children:"トップに戻る"}),(0,n.jsx)("span",{children:"/"}),(0,n.jsx)("button",{onClick:()=>x.push("/map"),className:"hover:underline",children:"地図から探す"})]})})]}):(0,n.jsx)("p",{className:"text-gray-400",children:"\uD83D\uDD0D 検索条件を選んで「検索」ボタンを押してください"})})}function x(){let e=(0,r.useSearchParams)(),t=(0,r.useRouter)(),[s,c]=(0,l.useState)([]),[i,d]=(0,l.useState)([]),[u,x]=(0,l.useState)([]),[h,p]=(0,l.useState)(!1),[m,f]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{var t,s,n;let l=(null===(t=e.get("genre"))||void 0===t?void 0:t.split(","))||[],r=(null===(s=e.get("area"))||void 0===s?void 0:s.split(","))||[],a=(null===(n=e.get("payment"))||void 0===n?void 0:n.split(","))||[],i="true"===e.get("open");c(l),d(r),x(a),p(i),""!==e.toString()&&f(!0)},[e]),(0,n.jsxs)("div",{className:"min-h-screen bg-[#FEFCF6] text-gray-800 px-4 py-6 space-y-10",children:[(0,n.jsx)("div",{id:"search-filter",children:(0,n.jsx)(a.A,{selectedGenres:s,setSelectedGenres:c,selectedAreas:i,setSelectedAreas:d,selectedPayments:u,setSelectedPayments:x,showOnlyOpen:h,setShowOnlyOpen:p,handleSearch:()=>{f(!1),setTimeout(()=>f(!0),100);let e=new URLSearchParams;s.length>0&&e.set("genre",s.join(",")),i.length>0&&e.set("area",i.join(",")),u.length>0&&e.set("payment",u.join(",")),h&&e.set("open","true"),t.push("/search?".concat(e.toString()))}})}),m&&(0,n.jsx)(o,{selectedGenres:s,selectedAreas:i,selectedPayments:u,showOnlyOpen:h,isSearchTriggered:m})]})}function h(){return(0,n.jsx)(l.Suspense,{fallback:(0,n.jsx)("p",{className:"text-gray-400 text-center text-[#FEFCF6] mt-6",children:"\uD83D\uDD0D 読み込み中..."}),children:(0,n.jsx)(x,{})})}},5353:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return l}});let n=s(2115);function l(e,t){let s=(0,n.useRef)(()=>{}),l=(0,n.useRef)(()=>{});return(0,n.useMemo)(()=>e&&t?n=>{null===n?(s.current(),l.current()):(s.current=r(e,n),l.current=r(t,n))}:e||t,[e,t])}function r(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let s=e(t);return"function"==typeof s?s:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}},e=>{var t=t=>e(e.s=t);e.O(0,[711,145,173,583,441,517,358],()=>t(3689)),_N_E=e.O()}]);